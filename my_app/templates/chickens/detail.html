{% extends 'base.html' %}
{% load static %}
{% block head %}
<link rel="stylesheet" href="{% static 'css/chickens/chicken-detail.css' %}" />
{% endblock %}
{% block content %}

<section class="chicken-container">
  <div class="chicken-img">
    <img src="{% static 'images/sk8r-boi-chicken.png' %}" alt="A rebellious skater chicken" />
  </div>

  <div class="chicken-details">
    <h1>{{ chicken.name }}</h1>

    {% if chicken.age > 0 %}
      <h2>A {{ chicken.age }} year old {{ chicken.breed }} (probably plotting your demise)</h2>
    {% else %}
      <h2>A tiny chick just learning to terrorize humans.</h2>
    {% endif %}

    <p>{{ chicken.description }}</p>

    <div class="chicken-actions">
    <a href="{% url 'chicken-update' chicken.id %}" class="btn warn">Mess with It</a>
    <a href="{% url 'chicken-delete' chicken.id %}" class="btn danger">Send to KFC</a>

    <h3>Chaos Meter</h3>
    <p>Currently at: <strong>{{ chicken.chaos_level }}%</strong></p>

    <h3>Favorite Snacks</h3>
    {% if chicken.snacks %}
      <ul>
        {% for snack in chicken.snacks %}
          <li>{{ snack }}</li>
        {% endfor %}
      </ul>
    {% else %}
      <p>This chicken is fasting… or just lazy.</p>
    {% endif %}
    </div>
  </div>
</section>
<div class="escape and">
  <section class="escapes">
    <div class="subsection-title">
      <h2>Escape Attempts 🏃‍♂️🐓</h2>
      
      <img src="{% static 'images/chicken-ninja.png' %}" alt="A ninja chicken plotting" />
      <img src="{% static 'images/chicken-tunnel.png' %}" alt="A chicken digging a tunnel" />
      <img src="{% static 'images/chicken-helicopter.png' %}" alt="A chicken trying to fly a toy helicopter" />
    </div>

    <table>
      <thead>
        <tr>
          <th>Date & Time</th>
          <th>Method</th>
          <th>Outcome</th>
        </tr>
      </thead>
      <tbody>
        {% for attempt in chicken.escapeattempt_set.all %}
          <tr>
            <td>{{ attempt.date }}</td>
            <td>{{ attempt.method }}</td>
            <td>
              {% if attempt.success %}
                ✅ Freedom! (at least until KFC finds out)
              {% else %}
                ❌ Epic Fail (back to the coop)
              {% endif %}
            </td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="3">
              This chicken hasn’t tried escaping yet…  
              (Or they’re just better at covering their tracks 🕵️‍♀️)
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

   <form action="{% url 'add-escape' chicken.id %}" method="post" class="escape-form">
  {% csrf_token %}

  <div class="form-group">
    <label for="{{ escape_form.date.id_for_label }}">{{ escape_form.date.label }}</label>
    {{ escape_form.date }}
  </div>

  <div class="form-group">
    <label for="{{ escape_form.method.id_for_label }}">{{ escape_form.method.label }}</label>
    {{ escape_form.method }}
    <small class="help-text">How did this feathered genius think it would work?</small>
  </div>

  <div class="form-group checkbox">
    {{ escape_form.success }}
    <label for="{{ escape_form.success.id_for_label }}">{{ escape_form.success.label }}</label>
  </div>

  <button type="submit" class="btn chaos">🚪🐔 Log Another Escape</button>
</form>

  </section>
</div>


{% endblock %}
